<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Super-Droplet Kokkos Aliases" href="kokkosaliases_sd.html" /><link rel="prev" title="Condensation" href="condensation.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Implicit Euler Method for Condensation - CLEO 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">CLEO 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">CLEO 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../intro/intro.html">Programming Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Programming Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro/background.html">Background to the Super-Droplet Model (SDM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/motivation.html">Motivation for CLEO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/memorylayout.html">Memory Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/monoids.html">Monoids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/coupling.html">Coupling to Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/timestepping.html">Timestepping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/kokkos.html">Kokkos Thread Parallelism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/extern.html">External Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/quickstart.html">Quickstart</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pySD/pySD.html">API: PySD</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API: PySD</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../pySD/gbxboundariesbinary_src/gbxboundariesbinary_src.html">GbxBoundariesBinary</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of GbxBoundariesBinary</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/gbxboundariesbinary_src/create_gbxboundaries.html">CREATE_GBXBOUNDARIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/gbxboundariesbinary_src/read_gbxboundaries.html">READ_GBXBOUNDARIES</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/initsuperdropsbinary_src.html">InitSuperdropsBinary</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of InitSuperdropsBinary</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/create_initsuperdrops.html">CREATE_INITSUPERDROPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/read_initsuperdrops.html">READ_INITSUPERDROPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/attrsgen.html">ATTRSGEN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/crdgens.html">CRDGENS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/probdists.html">PROBDISTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/rgens.html">RGENS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/initsuperdropsbinary_src/dryrgens.html">DRYRGENS</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../pySD/thermobinary_src/thermobinary_src.html">ThermoBinary</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of ThermoBinary</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/thermobinary_src/create_thermodynamics.html">CREATE_THERMODYNAMICS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/thermobinary_src/read_thermodynamics.html">READ_THERMODYNAMICS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/thermobinary_src/thermogen.html">THERMOGEN</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../pySD/sdmout_src/sdmout_src.html">SDMOut</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of SDMOut</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/pyzarr.html">PYZARR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/pysetuptxt.html">PYSETUPTXT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/pygbxsdat.html">PYGBXSDAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/timedata.html">TIMEDATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/thermodata.html">THERMODATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/supersdata.html">SUPERSDATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/sdtracing.html">SDTRACING</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/massmoms.html">MASSMOMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/thermoeqns.html">THERMOEQNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pySD/sdmout_src/ensembzarr.html">ENSEMBZARR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../pySD/cxx2py.html">CXX2PY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pySD/readconfigfile.html">READCONFIGFILE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pySD/editconfigfile.html">EDITCONFIGFILE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pySD/readbinary.html">READBINARY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pySD/writebinary.html">WRITEBINARY</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../cxx.html">API: C++ Library</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API: C++ Library</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../runcleo/runcleomod.html">RunCLEO Module</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of RunCLEO Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/coupleddynamics.html">CoupledDynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/couplingcomms.html">CouplingComms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/creategbxs.html">Create Gridboxes Sub-Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/createsupers.html">Create Super-droplets Sub-Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/runcleo.html">RunCLEO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runcleo/sdmmethods.html">SDMMethods</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="superdropsmod.html">Superdrops Module</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Superdrops Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="collisions/collisionsmod.html">Collisions Module</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Collisions Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="collisions/collisions.html">Collisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="collisions/collisionkinetics.html">Collision Kinetics</a></li>
<li class="toctree-l4"><a class="reference internal" href="collisions/coalescence.html">Coalescence</a></li>
<li class="toctree-l4"><a class="reference internal" href="collisions/coalbure.html">Coalescence-Breakup-Rebound</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="condensation.html">Condensation</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Implicit Euler Method for Condensation</a></li>
<li class="toctree-l3"><a class="reference internal" href="kokkosaliases_sd.html">Super-Droplet Kokkos Aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="microphysical_process.html">Microphysical Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="state.html">State</a></li>
<li class="toctree-l3"><a class="reference internal" href="superdrop.html">Superdrop</a></li>
<li class="toctree-l3"><a class="reference internal" href="superdrop_ids.html">Superdrop IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="superdrop_attrs.html">Superdrop Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="terminalvelocity.html">Terminal Velocities</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermodynamic_equations.html">Thermodynamic Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="urbg.html">Randomness Generation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../zarr/zarrmod.html">Zarr Module</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Zarr Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../zarr/buffer.html">Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/chunks.html">Chunks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/dataset.html">Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/fsstore.html">FSStore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/store_accessor.html">StoreAccessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/xarray_zarr_array.html">XarrayZarrArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/xarray_metadata.html">Xarray Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/zarr_array.html">ZarrArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/zarr_metadata.html">Zarr Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zarr/zarr_group.html">ZarrGroup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../observers/observersmod.html">Observers Module</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Observers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../observers/observers.html">Observers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/streamout_observer.html">StreamOut Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/runstats_observer.html">RunStatsObserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/consttstep_observer.html">Constant Time Step Observers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/write_to_dataset_observer.html">Template for Observer to Write To Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/parallel_write_data.html">Parallel Write Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/collect_data_for_dataset.html">Collect Data For Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/generic_collect_data.html">Generic Collect Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/time_observer.html">Time Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/gbxindex_observer.html">Gbxindex Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/superdrops_observer.html">Superdrops Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/nsupers_observer.html">Nsupers Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/totnsupers_observer.html">TotNsupers Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/state_observer.html">State Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/thermo_observer.html">Thermodynamics Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/windvel_observer.html">WindVel Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observers/massmoments_observer.html">Massmoments Observer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../initialise/initialisemod.html">RunCLEO Module</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of RunCLEO Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../initialise/initialconditions.html">InitialConditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cleoconstants.html">CLEO Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kokkosaliases.html">Kokkos Aliases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/ourdocs.html">Our Docs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/yoctoyotta1024/CLEO.git">GitHub Repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/good_coding.html">Good Coding Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/contact.html">Contact Us!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/cxx/superdrops/impliciteuler.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="implicit-euler-method-for-condensation">
<h1>Implicit Euler Method for Condensation<a class="headerlink" href="#implicit-euler-method-for-condensation" title="Link to this heading">¶</a></h1>
<p>Header file: <code class="docutils literal notranslate"><span class="pre">&lt;libs/superdrops/impliciteuler.hpp&gt;</span></code>
<a class="reference external" href="https://github.com/yoctoyotta1024/CLEO/blob/main/libs/superdrops/impliciteuler.hpp">[source]</a></p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv417ImplicitIteration">
<span id="_CPPv317ImplicitIteration"></span><span id="_CPPv217ImplicitIteration"></span><span id="ImplicitIteration"></span><span class="target" id="structImplicitIteration"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ImplicitIteration</span></span></span><a class="headerlink" href="#_CPPv417ImplicitIteration" title="Link to this definition">¶</a><br /></dt>
<dd><p>Struct defining parameters and methods for iterations of the Implicit Euler Method. </p>
<p>This struct defines parameters and methods for performing an iterations of the implicit method. E.g. struct defines the number of iterations to try before testing convergence, the timestep of the method, it’s relative and absolute tolerances, and methods for computing the initial guess for and performing the Newton-Raphson root finding.</p>
<p>_Note: abbreviation NR = Newton Raphson (Method) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration12initialguessEKd">
<span id="_CPPv3NK17ImplicitIteration12initialguessEKd"></span><span id="_CPPv2NK17ImplicitIteration12initialguessEKd"></span><span id="ImplicitIteration::initialguess__doubleCC"></span><span class="target" id="structImplicitIteration_1a16d6ac2bda6198060878f218a6fa3b30"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialguess</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration12initialguessEKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Returns appropriate initial guess (ie. a reasonable guess) for the Newton-Raphson method. </p>
<p>This method returns an initial guess for the Newton-Raphson method based on the given radius from the previous timestep and the current supersaturation ratio.</p>
<p>Guess is supposed to be a reasonable value for initial ‘ziter’ to use as first iteration of NR method in rootfinding algorithm for timestepping condensation/evaporation ODE. Here the guess criteria are as in SCALE-SDM for making initial guess for given droplet much greater than its (activation radius)^2 if the supersaturation &gt; its activation supersaturation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rprev</strong> – Radius of droplet at previous timestep. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial guess for ziter. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration18initialguess_shimaEKd">
<span id="_CPPv3NK17ImplicitIteration18initialguess_shimaEKd"></span><span id="_CPPv2NK17ImplicitIteration18initialguess_shimaEKd"></span><span id="ImplicitIteration::initialguess_shima__doubleCC"></span><span class="target" id="structImplicitIteration_1adac4f151d54ccf5b76ed600ad7113e17"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialguess_shima</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration18initialguess_shimaEKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Returns appropriate initial guess (ie. a reasonable guess) for the Newton-Raphson method. </p>
<p>This method returns an initial guess for the Newton-Raphson method based on the given radius from the previous timestep and the current supersaturation ratio.</p>
<p>Guess is supposed to be a reasonable value for initial ‘ziter’ to use as first iteration of NR method in rootfinding algorithm for timestepping condensation/evaporation ODE. Here the guess criteria are adapted from SCALE-SDM. Second criteria is that initial guess &gt;= ‘r1sqrd’, where r1 is the equilibrium radius of a given droplet when s_ratio=1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rprev</strong> – Radius of droplet at previous timestep. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial guess for ziter. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration25newtonraphson_niterationsEKdd">
<span id="_CPPv3NK17ImplicitIteration25newtonraphson_niterationsEKdd"></span><span id="_CPPv2NK17ImplicitIteration25newtonraphson_niterationsEKdd"></span><span id="ImplicitIteration::newtonraphson_niterations__doubleC.doubleC"></span><span class="target" id="structImplicitIteration_1a795044ca657a53be6375f9cc4635efe1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">newtonraphson_niterations</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ziter</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration25newtonraphson_niterationsEKdd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Performs Newton-Raphson iterations with a fixed number of iterations. </p>
<p>This method performs Newton-Raphson iterations for a fixed number of iterations, then tests for convergence and continues with futher iterations until convergence occurs or or until the maximum number of iterations is reached.</p>
<p>Funciton intergrates (timesteps) condensation ODE by delt given initial guess for ziter, (which is usually radius^squared from previous timestep). Uses Newton Raphson iterative method to find new value of the radius that converges on the root of the polynomial g(ziter) within the tolerances of the ImpIter instance. After ‘niters’ iterations, convergence criteria is tested and futher iterations undertaken if polynomial root has not yet been converged upon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rprev</strong> – Radius at previous timestep </p></li>
<li><p><strong>ziter</strong> – The current guess for ziter. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated value of ziter. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration28newtonraphson_untilconvergedEKjKdd">
<span id="_CPPv3NK17ImplicitIteration28newtonraphson_untilconvergedEKjKdd"></span><span id="_CPPv2NK17ImplicitIteration28newtonraphson_untilconvergedEKjKdd"></span><span id="ImplicitIteration::newtonraphson_untilconverged__unsigned-iC.doubleC.doubleC"></span><span class="target" id="structImplicitIteration_1a0a14ad125c47c8157f64cc0432abfc59"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">newtonraphson_untilconverged</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iterlimit</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ziter</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration28newtonraphson_untilconvergedEKjKdd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Performs Newton-Raphson iterations until convergence. </p>
<p>After every iteration, convergence criteria is tested and error is raised if method does not converge within ‘iterlimit’ iterations. Otherwise returns new value for the radius (which is the radius at timestep ‘t+subdelt’. Refer to section 5.1.2 Shima et al. 2009 and section 3.3.3 of Matsushima et al. 2023 for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterlimit</strong> – The maxiumum number of iterations to attempt. </p></li>
<li><p><strong>rprev</strong> – Radius at the previous timestep. </p></li>
<li><p><strong>ziter</strong> – The current guess for ziter. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated value of ziter. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration29iterate_rootfinding_algorithmEKdd">
<span id="_CPPv3NK17ImplicitIteration29iterate_rootfinding_algorithmEKdd"></span><span id="_CPPv2NK17ImplicitIteration29iterate_rootfinding_algorithmEKdd"></span><span id="ImplicitIteration::iterate_rootfinding_algorithm__doubleC.doubleC"></span><span class="target" id="structImplicitIteration_1ab0b92599f9aee4d736cc41dd0705cfda"></span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">bool</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">iterate_rootfinding_algorithm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ziter</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration29iterate_rootfinding_algorithmEKdd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform one iteration of the Newton-Raphson rootfinding algorithm. </p>
<p>This function performs one iteration of the Newton-Raphson rootfinding algorithm and returns the updated value of radius^2 alongside a boolean indicating whether the algorithm has converged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rprev</strong> – Radius at the previous timestep. </p></li>
<li><p><strong>ziter</strong> – The current guess for ziter. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pair indicating whether to continue iterating and the updated value of ziter. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration9ode_gfuncEKdKd">
<span id="_CPPv3NK17ImplicitIteration9ode_gfuncEKdKd"></span><span id="_CPPv2NK17ImplicitIteration9ode_gfuncEKdKd"></span><span id="ImplicitIteration::ode_gfunc__doubleC.doubleCC"></span><span class="target" id="structImplicitIteration_1a44ee10b85229f7d9c005a60727b53c9c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ode_gfunc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rsqrd</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration9ode_gfuncEKdKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Returns the value of g(z) / z * delt for the ODE. </p>
<p>This method computes the value of g(z) / z * delt used in the root-finding Newton-Raphson method for the dr/dt condensation / evaporation ODE.</p>
<p>ODE is for radial growth/shrink of each superdroplet due to condensation and diffusion of water vapour according to equations from “An Introduction To Clouds….” (see note at top of file).</p>
<p><em>Note:</em> z = ziter = radius^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rprev</strong> – Radius at the previous timestep. </p></li>
<li><p><strong>rsqrd</strong> – Current radius squared. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RHS of g(z) / z * delt evaluted at rqrd. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration19ode_gfuncderivativeEKd">
<span id="_CPPv3NK17ImplicitIteration19ode_gfuncderivativeEKd"></span><span id="_CPPv2NK17ImplicitIteration19ode_gfuncderivativeEKd"></span><span id="ImplicitIteration::ode_gfuncderivative__doubleCC"></span><span class="target" id="structImplicitIteration_1a640919a00cc4fecce381fcb8ea7007bc"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ode_gfuncderivative</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rsqrd</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration19ode_gfuncderivativeEKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Returns the value of the derivative of g(z) with respect to z. </p>
<p>This method computes the value of dg(z)/dz * delt, where dg(z)/dz is the derivative of g(z) with respect to z=rsqr. g(z) is polynomial to find root of using Newton Raphson Method consistent as in ode_gfunc(…).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rsqrd</strong> – Current radius squared. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RHS of dg(z)/dz * delt evaluted at rqrd. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK17ImplicitIteration15isnot_convergedEKdKd">
<span id="_CPPv3NK17ImplicitIteration15isnot_convergedEKdKd"></span><span id="_CPPv2NK17ImplicitIteration15isnot_convergedEKdKd"></span><span id="ImplicitIteration::isnot_converged__doubleC.doubleCC"></span><span class="target" id="structImplicitIteration_1a8be114cf356b3e96c8b289f875722d22"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isnot_converged</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gfunciter</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gfuncprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK17ImplicitIteration15isnot_convergedEKdKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Returns true if the Newton-Raphson iterations have <em>not</em> yet converged. </p>
<p>This method checks if the Newton-Raphson iterations have converged based on a standard local error test: |iteration - previous iteration| &lt; RTOL * |iteration| + ATOL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gfunciter</strong> – g(z) of current iteration </p></li>
<li><p><strong>gfuncprev</strong> – g(z) of previous iteration </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean=true if not yet converged, false otherwise </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration6nitersE">
<span id="_CPPv3N17ImplicitIteration6nitersE"></span><span id="_CPPv2N17ImplicitIteration6nitersE"></span><span id="ImplicitIteration::niters__unsigned-i"></span><span class="target" id="structImplicitIteration_1adc17ad8733f0521bba6479a39e6fd673"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">niters</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration6nitersE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Number of NR iterations to try before testing convergence. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration7subdeltE">
<span id="_CPPv3N17ImplicitIteration7subdeltE"></span><span id="_CPPv2N17ImplicitIteration7subdeltE"></span><span id="ImplicitIteration::subdelt__double"></span><span class="target" id="structImplicitIteration_1a81dc3cc60ef99ccdd0cd0c564d33feef"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">subdelt</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration7subdeltE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Timestep of implicit method (at each substep &gt;= niter NR iterations occur). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration4rtolE">
<span id="_CPPv3N17ImplicitIteration4rtolE"></span><span id="_CPPv2N17ImplicitIteration4rtolE"></span><span id="ImplicitIteration::rtol__double"></span><span class="target" id="structImplicitIteration_1a9caeee2098eb32dfb4abc9bc1e29f488"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rtol</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration4rtolE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Relative tolerance for convergence of NR method. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration4atolE">
<span id="_CPPv3N17ImplicitIteration4atolE"></span><span id="_CPPv2N17ImplicitIteration4atolE"></span><span id="ImplicitIteration::atol__double"></span><span class="target" id="structImplicitIteration_1afc9b3c232a3d4f226116aabeeeb5092f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">atol</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration4atolE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Absolute tolerance for convergence of NR method. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration7s_ratioE">
<span id="_CPPv3N17ImplicitIteration7s_ratioE"></span><span id="_CPPv2N17ImplicitIteration7s_ratioE"></span><span id="ImplicitIteration::s_ratio__double"></span><span class="target" id="structImplicitIteration_1a298b431071114afb6cb6f15ba6b0044b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">s_ratio</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration7s_ratioE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Supersaturation ratio. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration4akohE">
<span id="_CPPv3N17ImplicitIteration4akohE"></span><span id="_CPPv2N17ImplicitIteration4akohE"></span><span id="ImplicitIteration::akoh__double"></span><span class="target" id="structImplicitIteration_1af54e6cd3da1d8120cb78165bec3a4c95"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">akoh</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration4akohE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Kelvin factor in Kohler theory “a”. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration4bkohE">
<span id="_CPPv3N17ImplicitIteration4bkohE"></span><span id="_CPPv2N17ImplicitIteration4bkohE"></span><span id="ImplicitIteration::bkoh__double"></span><span class="target" id="structImplicitIteration_1a99191f57907a22b174376fe032d853bc"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bkoh</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration4bkohE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Raoult factor in Kohler theory “b”. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17ImplicitIteration7ffactorE">
<span id="_CPPv3N17ImplicitIteration7ffactorE"></span><span id="_CPPv2N17ImplicitIteration7ffactorE"></span><span id="ImplicitIteration::ffactor__double"></span><span class="target" id="structImplicitIteration_1a4ca85b94e3ff5bb44950fd587f92baf1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ffactor</span></span></span><a class="headerlink" href="#_CPPv4N17ImplicitIteration7ffactorE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Sum of heat and vapor diffusion factors. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv413ImplicitEuler">
<span id="_CPPv313ImplicitEuler"></span><span id="_CPPv213ImplicitEuler"></span><span id="ImplicitEuler"></span><span class="target" id="classImplicitEuler"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ImplicitEuler</span></span></span><a class="headerlink" href="#_CPPv413ImplicitEuler" title="Link to this definition">¶</a><br /></dt>
<dd><p>Class for Implicit Euler (IE) integration of superdroplet condensational growth / evaporational shrinking ODE. </p>
<p>This class performs Implicit Euler integration of the superdroplet condensation / evaporation ODE using a Newton-Raphson root finding method to solve the implicit timestep equation of a stiff ODE. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler13ImplicitEulerEKjKdKdKdKd">
<span id="_CPPv3N13ImplicitEuler13ImplicitEulerEKjKdKdKdKd"></span><span id="_CPPv2N13ImplicitEuler13ImplicitEulerEKjKdKdKdKd"></span><span id="ImplicitEuler::ImplicitEuler__unsigned-iC.doubleC.doubleC.doubleC.doubleC"></span><span class="target" id="classImplicitEuler_1a9972f248249d8ce783068eb9d7cf8eda"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ImplicitEuler</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">niters</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">maxrtol</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">maxatol</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subdelt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N13ImplicitEuler13ImplicitEulerEKjKdKdKdKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Constructor for <a class="reference internal" href="#classImplicitEuler"><span class="std std-ref">ImplicitEuler</span></a> class. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK13ImplicitEuler29solve_condensation_matsushimaEKdKN6Kokkos4pairIddEEKdKd">
<span id="_CPPv3NK13ImplicitEuler29solve_condensation_matsushimaEKdKN6Kokkos4pairIddEEKdKd"></span><span id="_CPPv2NK13ImplicitEuler29solve_condensation_matsushimaEKdKN6Kokkos4pairIddEEKdKd"></span><span id="ImplicitEuler::solve_condensation_matsushima__doubleC.Kokkos::pair:double.double:C.doubleC.doubleCC"></span><span class="target" id="classImplicitEuler_1a09502e4fb186491a6f45501548b344f7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_condensation_matsushima</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">s_ratio</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">akoh_bkoh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ffactor</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK13ImplicitEuler29solve_condensation_matsushimaEKdKN6Kokkos4pairIddEEKdKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Integrates the condensation / evaporation ODE employing the Implicit Euler method as in Matsushima et al, 2023. </p>
<p>Forward timestep previous radius ‘rprev’ by delt using an Implicit Euler method to integrate the condensation/evaporation ODE. Implict timestepping equation defined in section 5.1.2 of Shima et al. 2009 and is root of polynomial g(z) = 0, where z = [R_i(t+delt)]^squared.</p>
<p>Newton Raphson iterations are used to converge towards the root of g(z) within the tolerances of an ImpIter instance. Tolerances, maxium number of iterations and sub-timestepping are adjusted based on the uniqueness criteria of the polynomial g(z). Uniqueness criteria, ucrit1 and / or ucrit2, assume that solution to g(ziter)=0 is unique and therefore Newton Raphson root finding algorithm converges quickly. This means method can be used with comparitively large tolerances and timesteps, and the maximum number of iterations is small. Refer to section 5.1.2 of Shima et al. 2009 and section 3.3.3 of Matsushima et al. 2023 for more details. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK13ImplicitEuler18solve_condensationEKdKN6Kokkos4pairIddEEKdKd">
<span id="_CPPv3NK13ImplicitEuler18solve_condensationEKdKN6Kokkos4pairIddEEKdKd"></span><span id="_CPPv2NK13ImplicitEuler18solve_condensationEKdKN6Kokkos4pairIddEEKdKd"></span><span id="ImplicitEuler::solve_condensation__doubleC.Kokkos::pair:double.double:C.doubleC.doubleCC"></span><span class="target" id="classImplicitEuler_1a1b63b1f169ce60e723acf83e602d543b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_condensation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">s_ratio</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">akoh_bkoh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ffactor</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK13ImplicitEuler18solve_condensationEKdKN6Kokkos4pairIddEEKdKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Integrates the condensation / evaporation ODE employing the Implicit Euler method as in Shima et. al, 2023 with adjustments for near-supersaturation conditions. </p>
<p>Forward timestep previous radius ‘rprev’ by delt using an Implicit Euler method to integrate the condensation/evaporation ODE. Implict timestepping equation defined in section 5.1.2 of Shima et al. 2009 and is root of polynomial g(z) = 0, where z = [R_i(t+delt)]^squared.</p>
<p>Newton Raphson iterations are used to converge towards the root of g(z) within the tolerances of an ImpIter instance. Tolerances, maxium number of iterations and sub-timestepping are adjusted when near to supersaturation=1 (when activation / deactivation may occur). Far from activation, solution to g(ziter)=0 is usually unique and Newton Raphson root finding algorithm converges quickly. This means method can be used with comparitively large tolerances and timesteps, and the maximum number of iterations is small. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-functions">Private Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK13ImplicitEuler25substepped_implicitmethodERK17ImplicitIterationKjKd">
<span id="_CPPv3NK13ImplicitEuler25substepped_implicitmethodERK17ImplicitIterationKjKd"></span><span id="_CPPv2NK13ImplicitEuler25substepped_implicitmethodERK17ImplicitIterationKjKd"></span><span id="ImplicitEuler::substepped_implicitmethod__ImplicitIterationCR.unsigned-iC.doubleCC"></span><span class="target" id="classImplicitEuler_1aa66232e1b02866abf2893ae8e4652252"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">substepped_implicitmethod</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417ImplicitIteration" title="ImplicitIteration"><span class="n"><span class="pre">ImplicitIteration</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">implit</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nsubsteps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rprev</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK13ImplicitEuler25substepped_implicitmethodERK17ImplicitIterationKjKd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Performs the implicit method with sub-stepping. </p>
<p>This method performs the implicit method with substepping, iterating over the substeps to compute the implicit method for each substep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>implit</strong> – object defining implicit iterations. </p></li>
<li><p><strong>nsubsteps</strong> – number of substeps to perform. </p></li>
<li><p><strong>rprev</strong> – Radius of droplet at previous timestep. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New value for droplet radius. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler6nitersE">
<span id="_CPPv3N13ImplicitEuler6nitersE"></span><span id="_CPPv2N13ImplicitEuler6nitersE"></span><span id="ImplicitEuler::niters__unsigned-i"></span><span class="target" id="classImplicitEuler_1adf8130ad300457021e85f902394a1192"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">niters</span></span></span><a class="headerlink" href="#_CPPv4N13ImplicitEuler6nitersE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Suggested number of iterations for Newton Raphson method before testing for convergence. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler4deltE">
<span id="_CPPv3N13ImplicitEuler4deltE"></span><span id="_CPPv2N13ImplicitEuler4deltE"></span><span id="ImplicitEuler::delt__double"></span><span class="target" id="classImplicitEuler_1a4454bb8c2dcb20151f5ec832f52c335d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delt</span></span></span><a class="headerlink" href="#_CPPv4N13ImplicitEuler4deltE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Timestep of ODE solver (at each step implicit method is called). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler7maxrtolE">
<span id="_CPPv3N13ImplicitEuler7maxrtolE"></span><span id="_CPPv2N13ImplicitEuler7maxrtolE"></span><span id="ImplicitEuler::maxrtol__double"></span><span class="target" id="classImplicitEuler_1a8045189060f4e43a0fa78500b942aaa8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxrtol</span></span></span><a class="headerlink" href="#_CPPv4N13ImplicitEuler7maxrtolE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Adjustable relative tolerance for convergence of NR method. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler7maxatolE">
<span id="_CPPv3N13ImplicitEuler7maxatolE"></span><span id="_CPPv2N13ImplicitEuler7maxatolE"></span><span id="ImplicitEuler::maxatol__double"></span><span class="target" id="classImplicitEuler_1a0f0ade8b26048b62ca8051bc4bfd7f6b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxatol</span></span></span><a class="headerlink" href="#_CPPv4N13ImplicitEuler7maxatolE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Adjustable absolute tolerance for convergence of NR method. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13ImplicitEuler7subdeltE">
<span id="_CPPv3N13ImplicitEuler7subdeltE"></span><span id="_CPPv2N13ImplicitEuler7subdeltE"></span><span id="ImplicitEuler::subdelt__double"></span><span class="target" id="classImplicitEuler_1a9382c2956083473178c3e6dac357dc05"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">subdelt</span></span></span><a class="headerlink" href="#_CPPv4N13ImplicitEuler7subdeltE" title="Link to this definition">¶</a><br /></dt>
<dd><p>Number of substeps to intergation when supersat close to 1 (0 = false). </p>
</dd></dl>

</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="kokkosaliases_sd.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Super-Droplet Kokkos Aliases</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="condensation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Condensation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; (2023) MPI-M, Clara Bayley
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 18 June 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Implicit Euler Method for Condensation</a><ul>
<li><a class="reference internal" href="#_CPPv417ImplicitIteration"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration</span></code></a><ul>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration12initialguessEKd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::initialguess()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration18initialguess_shimaEKd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::initialguess_shima()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration25newtonraphson_niterationsEKdd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::newtonraphson_niterations()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration28newtonraphson_untilconvergedEKjKdd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::newtonraphson_untilconverged()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration29iterate_rootfinding_algorithmEKdd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::iterate_rootfinding_algorithm()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration9ode_gfuncEKdKd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::ode_gfunc()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration19ode_gfuncderivativeEKd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::ode_gfuncderivative()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK17ImplicitIteration15isnot_convergedEKdKd"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::isnot_converged()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration6nitersE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::niters</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration7subdeltE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::subdelt</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration4rtolE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::rtol</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration4atolE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::atol</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration7s_ratioE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::s_ratio</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration4akohE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::akoh</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration4bkohE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::bkoh</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N17ImplicitIteration7ffactorE"><code class="docutils literal notranslate"><span class="pre">ImplicitIteration::ffactor</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#_CPPv413ImplicitEuler"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler</span></code></a><ul>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler13ImplicitEulerEKjKdKdKdKd"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::ImplicitEuler()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK13ImplicitEuler29solve_condensation_matsushimaEKdKN6Kokkos4pairIddEEKdKd"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::solve_condensation_matsushima()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK13ImplicitEuler18solve_condensationEKdKN6Kokkos4pairIddEEKdKd"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::solve_condensation()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4NK13ImplicitEuler25substepped_implicitmethodERK17ImplicitIterationKjKd"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::substepped_implicitmethod()</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler6nitersE"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::niters</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler4deltE"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::delt</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler7maxrtolE"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::maxrtol</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler7maxatolE"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::maxatol</span></code></a></li>
<li><a class="reference internal" href="#_CPPv4N13ImplicitEuler7subdeltE"><code class="docutils literal notranslate"><span class="pre">ImplicitEuler::subdelt</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>